https://docs.swift.org/swift-book/LanguageGuide/ControlFlow.html#ID127 // if vs guard  
https://docs.swift.org/swift-book/LanguageGuide/AccessControl.html#ID17 // acccess  
https://shark-sea.kr/m/entry/Swift-%EA%B5%AC%EC%A1%B0%EC%B2%B4%EC%99%80-%ED%81%B4%EB%9E%98%EC%8A%A4-%EC%B0%A8%EC%9D%B4-struct-vs-class // 구조체 vs 클래스


//
//  JuiceMaker.swift
//  JuiceMaker
//
//  Created by Lina Lim on 11/16/20.
//  Copyright © 2020 llim. All rights reserved.
//

import Foundation

// 과일 종류
enum FruitName: String {
    case strawberry = "딸기"
    case banana = "바나나"
    case mango = "망고"
    case kiwi = "키위"
    case pineapple = "파인애플"
    case none = ""
}

// 쥬스 종류
enum JuiceName: String {
    case strawberryJuice = "딸기"
    case bananaJuice = "바나나"
    case mangoJuice = "망고"
    case kiwiJuice = "키위"
    case pineappleJuice = "파인애플"
    case strawberryBananaJuice = "딸기바나나"
    case mangoKiwiJuice = "망고키위"
    case none = ""
}

/// 과일
struct Fruit {
    private var name: FruitName
    private(set) var stock: Int
    
    init(name: FruitName, amount: Int = 10) {
        self.name = name
        self.stock = amount
    }
    
    mutating func addStock(amount: Int) {
        self.stock = stock + amount
    }
    
    mutating func useStock(amount: Int) {
        self.stock = stock - amount
    }
    
    mutating func checkStock(needAmount: Int) -> Bool {
        if stock >= needAmount {
            return true
        }
        debugPrint("\(name.rawValue) 재고부족")
        return false
    }
}
// 레시피 init할때 과일이랑 양을 받아 -> 레시피가 생성되겟네..?
struct Recipe {
    var recipe: [Material]
    
    mutating func addFruit(material: Material) {
        self.recipe.append(material)
    }
    
    func returnCount() -> Int {
        return recipe.count
    }
    
    func useStock() {
        for r in recipe {
            r.name
        }
    }
}

struct Material {
    var name: FruitName
    var amount: Int
    
    init(name: FruitName, amount: Int) {
        self.name = name
        self.amount = amount
    }
}


/// 쥬스 메이커
class JuiceMaker {
    private var selectedRecipe = Recipe(recipe: [Material(name: FruitName.banana, amount: 2)])
    private var selectedMenu = JuiceName.none
    
    private var strawberry = Fruit(name: .strawberry)
    private var banana = Fruit(name: .banana)
    private var pineapple = Fruit(name: .pineapple)
    private var kiwi = Fruit(name: .kiwi)
    private var mango = Fruit(name: .mango)
    
    let bananaJuice = Recipe(recipe: [Material(name: FruitName.banana, amount: 2)])
    // 쥬스 레시피
    /*
    private let strawberryJuice = [(name: FruitName.strawberry, amount: 16)]
    private let bananaJuice = [(name: FruitName.banana, amount: 2)]
    private let kiwiJuice = [(name: FruitName.kiwi, amount: 3)]
    private let mangoJuice = [(name: FruitName.mango, amount: 3)]
    private let pineappleJuice = [(name: FruitName.pineapple, amount: 2)]
    private let strawberryBananaJuice = [(name: FruitName.strawberry, amount: 10), (name: FruitName.banana, amount: 1)]
    private let mangoKiwiJuice = [(name: FruitName.mango, amount: 2), (name: FruitName.kiwi, amount: 1)]
    */
    /*
    /// 메뉴 접수
    func checkRecipe(menu: JuiceName) {
        switch menu {
        case .strawberryJuice:
            selectedRecipe = strawberryJuice
            selectedMenu = JuiceName.strawberryJuice
            
        case .bananaJuice:
            selectedRecipe = bananaJuice
            selectedMenu = JuiceName.bananaJuice
            
        case .kiwiJuice:
            selectedRecipe = kiwiJuice
            selectedMenu = JuiceName.kiwiJuice
            
        case .mangoJuice:
            selectedRecipe = mangoJuice
            selectedMenu = JuiceName.mangoJuice
            
        case .strawberryBananaJuice:
            selectedRecipe = strawberryBananaJuice
            selectedMenu = JuiceName.strawberryBananaJuice
            
        case .pineappleJuice:
            selectedRecipe = pineappleJuice
            selectedMenu = JuiceName.pineappleJuice
            
        case .mangoKiwiJuice:
            selectedRecipe = mangoKiwiJuice
            selectedMenu = JuiceName.mangoKiwiJuice
            
        case .none:
            return
        }
    }
    */
    
    /// 재고 확인
    func checkFruitStock(fruit: FruitName, amount: Int) -> Bool {
        switch fruit {
        case .banana:
            return banana.checkStock(needAmount: amount)
        case .kiwi:
            return kiwi.checkStock(needAmount: amount)
        case .mango:
            return mango.checkStock(needAmount: amount)
        case .strawberry:
            return strawberry.checkStock(needAmount: amount)
        case .pineapple:
            return pineapple.checkStock(needAmount: amount)
        default:
            return false
        }
    }
    
    
    /// 쥬스 만들기
    func makeJuice(menu: JuiceName) {
        // 레시피 확인
        //checkRecipe(menu: menu)
        //selectedMenu = .bananaJuice
        
        // 재고 확인
        var possible: Bool = true
        
        for recipeIndex in 0..<selectedRecipe.recipe.count {
            if !checkFruitStock(fruit: selectedRecipe.recipe[recipeIndex].name, amount: selectedRecipe.recipe[recipeIndex].amount) {
                possible = false
                break
            }
        }
        
        // 재고가 있다면 만들기
        if possible {
            switch selectedMenu {
            case .strawberryJuice:
                strawberry.useStock(amount: selectedRecipe.recipe[0].amount)
                
            case .bananaJuice:
                banana.useStock(amount: selectedRecipe.recipe[0].amount)
                
            case .kiwiJuice:
                kiwi.useStock(amount: selectedRecipe.recipe[0].amount)
                
            case .strawberryBananaJuice:
                strawberry.useStock(amount: selectedRecipe.recipe[0].amount)
                banana.useStock(amount: selectedRecipe.recipe[1].amount)
                
            case .pineappleJuice:
                pineapple.useStock(amount: selectedRecipe.recipe[0].amount)
                
            case .mangoJuice:
                mango.useStock(amount: selectedRecipe.recipe[0].amount)
                
            case .mangoKiwiJuice:
                mango.useStock(amount: selectedRecipe.recipe[0].amount)
                kiwi.useStock(amount: selectedRecipe.recipe[1].amount)
                
            default:
                return
            }
            debugPrint("\(selectedMenu.rawValue) 쥬스 완성")
        }
    }
}


let juiceMaker = JuiceMaker()
juiceMaker.makeJuice(menu: .bananaJuice)

